
# R Programming - Anomaly Detection 

## Example 

The following example has been borrowed from the following article: https://www.business-science.io/code-tools/2018/04/08/introducing-anomalize.html


```R
## Example 
# ---
# Find the anomalies on the following given time series dataset. 
# ---
# OUR CODE BELOW
# 

```


```R
# Installing anomalize package
# ---
# 
install.packages("anomalize")
```


```R
# Load tidyverse and anomalize
# ---
# 
library(tidyverse)
library(anomalize)
```


```R
# Collect our time series data
# ---
# 
tidyverse_cran_downloads
```


```R
# Detecting our anomalies
# ----
# We now use the following functions to detect and visualize anomalies; 
# We decomposed the “count” column into “observed”, “season”, “trend”, and “remainder” columns. 
# The default values for time series decompose are method = "stl", 
# which is just seasonal decomposition using a Loess smoother (refer to stats::stl()). 
# The frequency and trend parameters are automatically set based on the time scale (or periodicity)
# of the time series using tibbletime based function under the hood.
# time_decompose() - this function would help with time series decomposition.
# 
# anomalize() - 
# We perform anomaly detection on the decomposed data using 
# the remainder column through the use of the anomalize() function 
# which procides 3 new columns; “remainder_l1” (lower limit), 
# “remainder_l2” (upper limit), and “anomaly” (Yes/No Flag).
# The default method is method = "iqr", which is fast and relatively 
# accurate at detecting anomalies. 
# The alpha parameter is by default set to alpha = 0.05, 
# but can be adjusted to increase or decrease the height of the anomaly bands, 
# making it more difficult or less difficult for data to be anomalous. 
# The max_anoms parameter is by default set to a maximum of max_anoms = 0.2 
# for 20% of data that can be anomalous. 
# 
# time_recompose()-
# We create the lower and upper bounds around the “observed” values 
# through the use of the time_recompose() function, which recomposes 
# the lower and upper bounds of the anomalies around the observed values.
# We create new columns created: “recomposed_l1” (lower limit) 
# and “recomposed_l2” (upper limit).
# 
# plot_anomalies() - 
# we now plot using plot_anomaly_decomposition() to visualize out data.
# 
# ---
# 
tidyverse_cran_downloads %>%
    time_decompose(count) %>%
    anomalize(remainder) %>%
    time_recompose() %>%
    plot_anomalies(time_recomposed = TRUE, ncol = 3, alpha_dots = 0.5)
```

## Challenge 


```R
## Challenge 
# ---
# Find the anomalies on the following given time series dataset.
# ---
# OUR CODE GOES BELOW
# 

logs_path <- "http://bit.ly/LogsDataset"

# Grouping by server and converting to tibbletime
security_access_logs <- read_csv(logs_path) %>%
  group_by(server) %>%
  as_tbl_time(date)

security_access_logs

```
